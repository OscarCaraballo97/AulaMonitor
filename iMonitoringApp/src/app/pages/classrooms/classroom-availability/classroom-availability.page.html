<ion-header>
  <ion-toolbar color="primary" class="dark:bg-kwd-darker">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/app/classrooms"></ion-back-button> </ion-buttons>
    <ion-title class="dark:text-kwd-light">
      {{ classroom ? 'Disponibilidad: ' + classroom.name : 'Disponibilidad de Aulas' }}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding bg-gray-100 dark:bg-kwd-dark">
  <div class="p-2 md:p-4">
    <div *ngIf="!classroomId && allClassrooms.length > 0" class="mb-4">
      <ion-item class="rounded-md shadow-sm dark:bg-kwd-darker">
        <ion-label position="stacked" class="dark:text-gray-300">Selecciona un Aula</ion-label>
        <ion-select [(ngModel)]="selectedClassroomId" (ionChange)="onClassroomChange()" interface="popover"
                    placeholder="Elige un aula para ver su horario"
                    class="dark:text-kwd-light">
          <ion-select-option *ngFor="let room of allClassrooms" [value]="room.id">
            {{ room.name }}
          </ion-select-option>
        </ion-select>
      </ion-item>
    </div>
    <div *ngIf="!classroomId && allClassrooms.length === 0 && !isLoading" class="text-center text-gray-500 dark:text-gray-400">
        No hay aulas para mostrar.
    </div>

    <div *ngIf="isLoading && !calendarApi" class="flex items-center justify-center h-64">
      <ion-spinner name="crescent"></ion-spinner>
      <p class="ml-2">Cargando calendario...</p> </div>

    <div *ngIf="selectedClassroomId || classroomId" class="bg-white rounded-lg shadow-md p-2 md:p-4 dark:bg-kwd-darker">
      <full-calendar #availabilityCalendar [options]="calendarOptions"></full-calendar>
    </div>
    <div *ngIf="!selectedClassroomId && !classroomId && !isLoading && allClassrooms.length > 0" class="mt-4 text-center text-gray-500 dark:text-gray-400">
      <p>Por favor, selecciona un aula para ver su disponibilidad.</p>
    </div>

  </div>
</ion-content>
